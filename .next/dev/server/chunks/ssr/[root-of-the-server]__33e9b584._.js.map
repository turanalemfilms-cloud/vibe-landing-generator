{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/gulzhanserikbay/vibe-landing-generator/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\nexport function supabaseBrowser() {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n  if (!url || !anon) throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL / NEXT_PUBLIC_SUPABASE_ANON_KEY')\n  return createClient(url, anon)\n}\n\nexport function supabaseServer() {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const service = process.env.SUPABASE_SERVICE_ROLE_KEY\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n  if (!url) throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL')\n\n  // Prefer service role for server-side writes. Fallback to anon for quick demo.\n  const key = service || anon\n  if (!key) throw new Error('Missing SUPABASE_SERVICE_ROLE_KEY or NEXT_PUBLIC_SUPABASE_ANON_KEY')\n\n  return createClient(url, key, {\n    auth: { persistSession: false },\n  })\n}\n\nexport function supabaseServerWithAccessToken(accessToken: string) {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const anon = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n  if (!url || !anon) throw new Error('Missing NEXT_PUBLIC_SUPABASE_URL / NEXT_PUBLIC_SUPABASE_ANON_KEY')\n  if (!accessToken) throw new Error('Missing access token')\n\n  // Use anon key + user JWT so RLS applies server-side.\n  return createClient(url, anon, {\n    auth: { persistSession: false },\n    global: {\n      headers: {\n        Authorization: `Bearer ${accessToken}`,\n      },\n    },\n  })\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,SAAS;IACd,MAAM;IACN,MAAM;IACN;;IACA,OAAO,IAAA,8LAAY,EAAC,KAAK;AAC3B;AAEO,SAAS;IACd,MAAM;IACN,MAAM,UAAU,QAAQ,GAAG,CAAC,yBAAyB;IACrD,MAAM;IAEN;;IAEA,+EAA+E;IAC/E,MAAM,MAAM,WAAW;IACvB;;IAEA,OAAO,IAAA,8LAAY,EAAC,KAAK,KAAK;QAC5B,MAAM;YAAE,gBAAgB;QAAM;IAChC;AACF;AAEO,SAAS,8BAA8B,WAAmB;IAC/D,MAAM;IACN,MAAM;IACN;;IACA,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;IAElC,sDAAsD;IACtD,OAAO,IAAA,8LAAY,EAAC,KAAK,MAAM;QAC7B,MAAM;YAAE,gBAAgB;QAAM;QAC9B,QAAQ;YACN,SAAS;gBACP,eAAe,CAAC,OAAO,EAAE,aAAa;YACxC;QACF;IACF;AACF"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/gulzhanserikbay/vibe-landing-generator/src/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useMemo, useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { supabaseBrowser } from '@/lib/supabase'\n\ntype ChatMessage = { role: 'user' | 'assistant'; content: string }\n\ntype ChatState = {\n  step: 'collecting' | 'style' | 'generated'\n  brief?: any\n  styleKey?: string\n  siteId?: string\n}\n\ntype ChatResponse = {\n  assistantMessage: string\n  nextState: ChatState\n  briefComplete?: boolean\n  styles?: Array<{ key: string; label: string; description?: string }>\n  siteUrl?: string\n  error?: string\n}\n\nconst STYLE_LABELS: Record<string, string> = {\n  minimalist_tech: 'Minimalist Tech',\n  bold_modern: 'Bold Modern',\n  clean_corporate: 'Clean Corporate',\n}\n\nexport default function HomePage() {\n  const router = useRouter()\n\n  useEffect(() => {\n    const supabase = supabaseBrowser()\n    supabase.auth.getSession().then(({ data }) => {\n      router.replace(data.session ? '/dashboard' : '/login')\n    })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // MVP: route users into the authenticated flow (login/dashboard/builder).\n  // Keep this page as a simple entry point.\n  const [messages, setMessages] = useState<ChatMessage[]>([\n    {\n      role: 'assistant',\n      content:\n        'Сәлем! Мен AI лендинг генераторымын. 1) Бизнес атауы қандай? 2) Кімге сатасыз (аудитория)?',\n    },\n  ])\n  const [input, setInput] = useState('')\n  const [state, setState] = useState<ChatState>({ step: 'collecting' })\n  const [isLoading, setIsLoading] = useState(false)\n\n  const styleChoices = useMemo(() => {\n    if (state.step !== 'style') return []\n    return Object.entries(STYLE_LABELS).map(([key, label]) => ({\n      key,\n      label,\n      description:\n        key === 'minimalist_tech'\n          ? 'Қараңғы, минимал, glassy'\n          : key === 'bold_modern'\n            ? 'Контраст, батыл accent'\n            : 'Ақ/жеңіл, корпоратив стиль',\n    }))\n  }, [state.step])\n\n  async function send(userText: string) {\n    setIsLoading(true)\n    try {\n      const res = await fetch('/api/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          messages: [{ role: 'user', content: userText }],\n          state,\n        }),\n      })\n\n      const rawText = await res.text()\n      let data: ChatResponse | null = null\n      try {\n        data = rawText ? (JSON.parse(rawText) as ChatResponse) : null\n      } catch {\n        data = null\n      }\n\n      if (!res.ok) {\n        const msg = data?.error || `API error (${res.status})`\n        const details = (data as any)?.details ? `\\n${(data as any).details}` : ''\n        throw new Error(msg + details)\n      }\n      if (!data) throw new Error('API returned empty response')\n      if (data.error) throw new Error(data.error)\n\n      setMessages((m) => [...m, { role: 'assistant', content: data.assistantMessage }])\n      setState(data.nextState)\n\n      if (data.siteUrl) {\n        const isAbsolute = /^https?:\\/\\//i.test(data.siteUrl)\n        const fullUrl = isAbsolute ? data.siteUrl : `${window.location.origin}${data.siteUrl}`\n        setMessages((m) => [\n          ...m,\n          {\n            role: 'assistant',\n            content: `Дайын! Мына линк: ${fullUrl}`,\n          },\n        ])\n      }\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  async function onSubmit(e: React.FormEvent) {\n    e.preventDefault()\n    const text = input.trim()\n    if (!text || isLoading) return\n    setInput('')\n    setMessages((m) => [...m, { role: 'user', content: text }])\n    try {\n      await send(text)\n    } catch (err: any) {\n      setMessages((m) => [\n        ...m,\n        {\n          role: 'assistant',\n          content: `Қате шықты:\\n${String(err?.message || err)}`,\n        },\n      ])\n    }\n  }\n\n  async function pickStyle(key: string) {\n    if (isLoading) return\n    setMessages((m) => [...m, { role: 'user', content: `Style: ${key}` }])\n    await send(`Мен ${key} стилін таңдаймын.`)\n  }\n\n  return (\n    <div className=\"min-h-dvh bg-gradient-to-b from-slate-950 via-slate-950 to-black text-white\">\n      <div className=\"mx-auto max-w-4xl px-4 py-10\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div>\n            <h1 className=\"text-2xl font-semibold tracking-tight\">Vibe Coding — AI Landing Page Generator</h1>\n            <p className=\"mt-1 text-sm text-white/70\">Чат арқылы бриф жинап, стиль таңдап, live link береміз.</p>\n          </div>\n          <a\n            className=\"hidden sm:inline-flex rounded-xl bg-white/10 border border-white/10 px-4 py-2 text-sm hover:bg-white/15\"\n            href=\"/site/demo\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            Demo route\n          </a>\n        </div>\n\n        <div className=\"mt-6 rounded-2xl border border-white/10 bg-white/5 backdrop-blur p-4\">\n          <div className=\"max-h-[55vh] overflow-auto space-y-3 pr-1\">\n            {messages.map((m, idx) => (\n              <div\n                key={idx}\n                className={\n                  m.role === 'user'\n                    ? 'ml-auto w-fit max-w-[85%] rounded-2xl bg-sky-400 text-slate-950 px-4 py-2'\n                    : 'mr-auto w-fit max-w-[85%] rounded-2xl bg-white/10 border border-white/10 px-4 py-2'\n                }\n              >\n                <div className=\"text-sm whitespace-pre-wrap\">{m.content}</div>\n              </div>\n            ))}\n          </div>\n\n          {state.step === 'style' && (\n            <div className=\"mt-4 flex flex-col gap-2\">\n              <div className=\"text-sm text-white/70\">Стиль таңда:</div>\n              <div className=\"grid sm:grid-cols-3 gap-2\">\n                {styleChoices.map((s) => (\n                  <button\n                    key={s.key}\n                    onClick={() => pickStyle(s.key)}\n                    className=\"rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left hover:bg-white/10\"\n                  >\n                    <div className=\"font-medium\">{s.label}</div>\n                    <div className=\"text-xs text-white/60 mt-1\">{s.description}</div>\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <form onSubmit={onSubmit} className=\"mt-4 flex gap-2\">\n            <input\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              placeholder={isLoading ? 'Жүктелуде…' : 'Жауапты жазыңыз…'}\n              className=\"flex-1 rounded-2xl border border-white/10 bg-white/5 px-4 py-3 outline-none focus:ring-4 focus:ring-sky-400/20\"\n              disabled={isLoading}\n            />\n            <button\n              className=\"rounded-2xl bg-sky-400 text-slate-950 px-5 font-semibold hover:opacity-90 disabled:opacity-60\"\n              disabled={isLoading}\n            >\n              Жіберу\n            </button>\n          </form>\n\n          <div className=\"mt-3 text-xs text-white/60\">\n            Step: <span className=\"text-white/80\">{state.step}</span>\n            {state.siteId ? (\n              <>\n                {' '}\n                • Site ID: <span className=\"text-white/80\">{state.siteId}</span>\n              </>\n            ) : null}\n          </div>\n        </div>\n\n        <div className=\"mt-6 text-sm text-white/70\">\n          <div className=\"font-medium text-white\">Next:</div>\n          <ul className=\"list-disc pl-5 mt-1 space-y-1\">\n            <li>Supabase Auth қосып, insert/update RLS-ты қатаңдату</li>\n            <li>Style → Tailwind tokens mapping-ты кеңейту (font, spacing, radius)</li>\n            <li>Screenshot generation (Puppeteer) + Storage upload</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}